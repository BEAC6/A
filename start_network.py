#!/usr/bin/env python3
"""
๐ ูุดุฑ ููุตุฉ ุงููุณุงุจูุงุช ุงูุฑูุงุถูุฉ ุนูู ุงูุดุจูุฉ ุงููุญููุฉ
Network deployment for math competition platform
"""

import subprocess
import sys
import webbrowser
import time
import socket

def get_local_ip():
    """ุงูุญุตูู ุนูู ุนููุงู IP ุงููุญูู ููุฌูุงุฒ"""
    try:
        # ุฅูุดุงุก ุงุชุตุงู ูููู ููุญุตูู ุนูู IP ุงููุญูู
        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        s.connect(("8.8.8.8", 80))
        local_ip = s.getsockname()[0]
        s.close()
        return local_ip
    except:
        return "192.168.1.156"  # IP ุงูุชุฑุงุถู

def create_network_access_guide(ip_address):
    """ุฅูุดุงุก ุฏููู ุงููุตูู ููุดุจูุฉ ุงููุญููุฉ"""
    guide_content = f"""# ๐ ุฏููู ุงููุตูู ููุดุจูุฉ ุงููุญููุฉ - ููุตุฉ ุงููุณุงุจูุงุช ุงูุฑูุงุถูุฉ

## ๐ **ุชู ูุดุฑ ุงูุชุทุจูู ุจูุฌุงุญ ุนูู ุงูุดุจูุฉ ุงููุญููุฉ!**

ุงูุชุทุจูู ุงูุขู ูุชุงุญ ูุฌููุน ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ ุจููุณ ุงูุดุจูุฉ ุงููุญููุฉ.

---

## ๐ **ุนูุงููู ุงููุตูู ููุชุทุจูู**

### ๐ฅ๏ธ **ูู ุงูุฌูุงุฒ ุงููุถูู (ุฌูุงุฒู):**
- **ุงูุฑุงุจุท ุงููุญูู**: http://localhost:8000
- **ุงูุฑุงุจุท ุจู IP**: http://{ip_address}:8000

### ๐ฑ **ูู ุงูุฃุฌูุฒุฉ ุงูุฃุฎุฑู ูู ุงูุดุจูุฉ:**
- **ุงูุฑุงุจุท ุงูุฑุฆูุณู**: http://{ip_address}:8000

---

## ๐ฏ **ุฑูุงุจุท ูุจุงุดุฑุฉ ูููุตูู ุงูุณุฑูุน**

### ๐จโ๐ซ **ูููุนูููู ูุงูุฅุฏุงุฑููู:**
- **ุชุณุฌูู ุฏุฎูู ุงููุนูููู**: http://{ip_address}:8000/accounts/login/
- **ููุญุฉ ุงูุฅุฏุงุฑุฉ**: http://{ip_address}:8000/admin/

### ๐ฅ **ููุทูุงุจ:**
- **ุชุณุฌูู ุฏุฎูู ุงูุทูุงุจ**: http://{ip_address}:8000/student/login/
- **ุฑูุฒ ุฏุฎูู ุงูุทูุงุจ**: `ben25`

---

## ๐ **ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู**

### ๐จโ๐ผ **ุญุณุงุจ ุงููุฏูุฑ/ุงููุนูู:**
- **ุงุณู ุงููุณุชุฎุฏู**: `admin`
- **ูููุฉ ุงููุฑูุฑ**: `[ูุญุฌูุจุฉ ูุฃุบุฑุงุถ ุงูุฃูุงู]`
- **ุงูุจุฑูุฏ ุงูุฅููุชุฑููู**: `admin@example.com`

### ๐ฅ **ุฏุฎูู ุงูุทูุงุจ:**
- **ุฑูุฒ ุงูุฏุฎูู**: `ben25`
- ูุง ูุญุชุงุฌ ุงุณู ูุณุชุฎุฏู ุฃู ูููุฉ ูุฑูุฑ

---

## ๐ฑ **ููููุฉ ุงููุตูู ูู ุงูุฃุฌูุฒุฉ ุงููุฎุชููุฉ**

### ๐ฅ๏ธ **ูู ุฃุฌูุฒุฉ ุงูููุจููุชุฑ:**
1. ุงูุชุญ ุฃู ูุชุตูุญ ููุจ (Chrome, Firefox, Edge, Safari)
2. ุงูุชุจ ูู ุดุฑูุท ุงูุนููุงู: `http://{ip_address}:8000`
3. ุงุถุบุท Enter

### ๐ฑ **ูู ุงูููุงุชู ุงูุฐููุฉ:**
1. ุงูุชุญ ูุชุตูุญ ุงููุงุชู
2. ุงูุชุจ ูู ุดุฑูุท ุงูุนููุงู: `http://{ip_address}:8000`
3. ุงุถุบุท ุนูู ุฒุฑ ุงูุฐูุงุจ

### ๐ป **ูู ุงูุฃุฌูุฒุฉ ุงูููุญูุฉ:**
1. ุงูุชุญ ูุชุตูุญ ุงูุฌูุงุฒ ุงูููุญู
2. ุงูุชุจ ูู ุดุฑูุท ุงูุนููุงู: `http://{ip_address}:8000`
3. ุงุถุบุท Enter ุฃู ุฒุฑ ุงูุฐูุงุจ

---

## ๐ง **ูุนูููุงุช ุชูููุฉ**

### ๐ **ุฅุนุฏุงุฏุงุช ุงูุดุจูุฉ:**
- **ุนููุงู IP ููุฎุงุฏู**: {ip_address}
- **ุงููููุฐ**: 8000
- **ุงูุจุฑูุชูููู**: HTTP
- **ููุน ุงูุดุจูุฉ**: ุดุจูุฉ ูุญููุฉ (LAN)

### โ๏ธ **ุฅุนุฏุงุฏุงุช ุงูุฎุงุฏู:**
- **ุฅุทุงุฑ ุงูุนูู**: Django 5.2.1
- **ูุงุนุฏุฉ ุงูุจูุงูุงุช**: SQLite
- **ุงูุฎุงุฏู**: Django Development Server
- **ุงููุถุน**: Development Mode

---

## ๐ก๏ธ **ุงูุฃูุงู ูุงููุตูู**

### โ **ุงูุฃุฌูุฒุฉ ุงููุณููุญ ููุง ุจุงููุตูู:**
- ุฌููุน ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ ุจููุณ ุงูุดุจูุฉ ุงููุญููุฉ
- ุฃุฌูุฒุฉ ุงูููุจููุชุฑ ูู ููุณ ุงูููุชุจ/ุงูููุฒู
- ุงูููุงุชู ุงูุฐููุฉ ุงููุชุตูุฉ ุจููุณ ุงูู WiFi
- ุงูุฃุฌูุฒุฉ ุงูููุญูุฉ ูู ููุณ ุงูุดุจูุฉ

### โ **ุงูุฃุฌูุฒุฉ ุบูุฑ ุงููุณููุญ ููุง:**
- ุงูุฃุฌูุฒุฉ ุฎุงุฑุฌ ุงูุดุจูุฉ ุงููุญููุฉ
- ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ ุจุดุจูุงุช ุฃุฎุฑู
- ุงููุตูู ูู ุงูุฅูุชุฑูุช ุงูุนุงู

---

## ๐ **ุฎุทูุงุช ุงูุงุณุชุฎุฏุงู**

### ๐จโ๐ซ **ูููุนูููู:**
1. ุงุฐูุจ ุฅูู: http://{ip_address}:8000/accounts/login/
2. ุณุฌู ุฏุฎููู ุจุญุณุงุจ ุงููุนูู
3. ุงุจุฏุฃ ูู ุฅูุดุงุก ุงููุณุงุจูุงุช ูุฅุฏุงุฑุฉ ุงูุทูุงุจ

### ๐ฅ **ููุทูุงุจ:**
1. ุงุฐูุจ ุฅูู: http://{ip_address}:8000/student/login/
2. ุฃุฏุฎู ุฑูุฒ ุงูุฏุฎูู: `ben25`
3. ุงุจุฏุฃ ูู ุญู ุงููุณุงุจูุงุช ุงููุชุงุญุฉ

---

## ๐ฏ **ูุตุงุฆุญ ููุงุณุชุฎุฏุงู ุงูุฃูุซู**

### ๐ฑ **ููุฃุฌูุฒุฉ ุงููุญูููุฉ:**
- ุงุณุชุฎุฏู ุงููุถุน ุงูุฃููู ููุดุงุดุงุช ุงูุฃูุจุฑ
- ุชุฃูุฏ ูู ุงุชุตุงู WiFi ููู
- ุฃุบูู ุงูุชุทุจููุงุช ุงูุฃุฎุฑู ูุชุญุณูู ุงูุฃุฏุงุก

### ๐ฅ๏ธ **ูุฃุฌูุฒุฉ ุงูููุจููุชุฑ:**
- ุงุณุชุฎุฏู ูุชุตูุญ ุญุฏูุซ ููุญุตูู ุนูู ุฃูุถู ุชุฌุฑุจุฉ
- ูุนู JavaScript ููุญุตูู ุนูู ุฌููุน ุงูููุฒุงุช
- ุงุณุชุฎุฏู ุดุงุดุฉ ูุงููุฉ ูููุณุงุจูุงุช

---

## ๐จ **ุงุณุชูุดุงู ุงูุฃุฎุทุงุก**

### โ **ุฅุฐุง ูู ูุชููู ุฌูุงุฒ ูู ุงููุตูู:**
1. ุชุฃูุฏ ูู ุงุชุตุงู ุงูุฌูุงุฒ ุจููุณ ุงูุดุจูุฉ
2. ุชุญูู ูู ุนููุงู IP: `{ip_address}`
3. ุชุฃูุฏ ูู ุฃู ุงูุฎุงุฏู ูุนูู
4. ุฌุฑุจ ุฅุนุงุฏุฉ ุชุดุบูู ุงููุชุตูุญ

### ๐ง **ุฅุฐุง ูุงู ุงูุงุชุตุงู ุจุทูุก:**
1. ุชุญูู ูู ููุฉ ุฅุดุงุฑุฉ WiFi
2. ุฃุบูู ุงูุชุทุจููุงุช ุบูุฑ ุงููุณุชุฎุฏูุฉ
3. ุฌุฑุจ ูุชุตูุญ ูุฎุชูู

---

## ๐ **ุญุงูุฉ ุงูุฎุงุฏู**

### โ **ุงูุฎุงุฏู ูุนูู ุญุงููุงู:**
- **ุงูุญุงูุฉ**: ๐ข ูุชุตู ููุนูู
- **ุงูุนููุงู**: http://0.0.0.0:8000
- **ูุชุงุญ ุนูู**: ุฌููุน ูุงุฌูุงุช ุงูุดุจูุฉ
- **ุนููุงู IP**: {ip_address}

### ๐ **ุฅุญุตุงุฆูุงุช:**
- **ุฅุทุงุฑ ุงูุนูู**: Django 5.2.1
- **ูุถุน ุงูุชุทููุฑ**: ููุนู
- **ูุฑุงูุจุฉ ุงููููุงุช**: ููุนูุฉ
- **ุฅุนุงุฏุฉ ุงูุชุญููู ุงูุชููุงุฆู**: ููุนูุฉ

---

## ๐ **ูุจุฑูู!**

**ุงูุชุทุจูู ุงูุขู ูุชุงุญ ูุฌููุน ุงูุฃุฌูุฒุฉ ูู ุงูุดุจูุฉ ุงููุญููุฉ! ๐**

ุดุงุฑู ุนููุงู IP ูุน ุงููุณุชุฎุฏููู: **http://{ip_address}:8000**
"""
    
    with open("NETWORK_ACCESS_GUIDE.md", "w", encoding="utf-8") as f:
        f.write(guide_content)

def main():
    print("๐ ููุตุฉ ุงููุณุงุจูุงุช ุงูุฑูุงุถูุฉ - ุงููุดุฑ ุนูู ุงูุดุจูุฉ ุงููุญููุฉ")
    print("=" * 60)
    print()
    
    # ุงูุญุตูู ุนูู ุนููุงู IP ุงููุญูู
    local_ip = get_local_ip()
    print(f"๐ ุชู ุงูุชุดุงู ุนููุงู IP: {local_ip}")
    print()
    
    try:
        # ุชุญุถูุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช
        print("๐ ุชุญุถูุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช...")
        subprocess.run([sys.executable, "manage.py", "migrate"], check=True)
        
        # ุชุฌููุน ุงููููุงุช ุงูุซุงุจุชุฉ
        print("๐ ุชุฌููุน ุงููููุงุช ุงูุซุงุจุชุฉ...")
        subprocess.run([sys.executable, "manage.py", "collectstatic", "--noinput"], check=True)
        
        # ุฅูุดุงุก ุฏููู ุงููุตูู ููุดุจูุฉ
        print("๐ ุฅูุดุงุก ุฏููู ุงููุตูู ููุดุจูุฉ ุงููุญููุฉ...")
        create_network_access_guide(local_ip)
        
        print()
        print("๐ ุจุฏุก ุชุดุบูู ุงูุฎุงุฏู ุนูู ุงูุดุจูุฉ ุงููุญููุฉ...")
        print("๐ ูุชุงุญ ุนูู ุฌููุน ูุงุฌูุงุช ุงูุดุจูุฉ")
        print(f"๐ ุงูุฑุงุจุท ุงููุญูู: http://localhost:8000")
        print(f"๐ ุฑุงุจุท ุงูุดุจูุฉ: http://{local_ip}:8000")
        print(f"๐ฅ ุฑุงุจุท ุงูุชูุงููุฐ: http://{local_ip}:8000/student/login/")
        print(f"๐จโ๐ซ ุฑุงุจุท ุงูุฃุณุงุชุฐุฉ: http://{local_ip}:8000/accounts/login/")
        print("๐ ุฑูุฒ ุฏุฎูู ุงูุชูุงููุฐ: ben25")
        print()
        print("๐ ุชู ุฅูุดุงุก ุฏููู ุงููุตูู: NETWORK_ACCESS_GUIDE.md")
        print("โน๏ธ ูุฅููุงู ุงูุฎุงุฏู: ุงุถุบุท Ctrl+C")
        print("=" * 60)
        print()
        
        # ุงูุชุธุงุฑ ูููู ุซู ูุชุญ ุงููุชุตูุญ
        time.sleep(2)
        try:
            webbrowser.open(f'http://{local_ip}:8000')
            print("๐ ุชู ูุชุญ ุงููุชุตูุญ ุชููุงุฆูุงู")
        except:
            print(f"๐ ุงูุชุญ ุงููุชุตูุญ ูุฏููุงู ุนูู: http://{local_ip}:8000")
        
        print()
        print("๐ฏ ุดุงุฑู ูุฐุง ุงูุฑุงุจุท ูุน ุงููุณุชุฎุฏููู:")
        print(f"   http://{local_ip}:8000")
        print()
        
        # ุชุดุบูู Django ุนูู ุฌููุน ูุงุฌูุงุช ุงูุดุจูุฉ
        subprocess.run([sys.executable, "manage.py", "runserver", "0.0.0.0:8000"])
        
    except KeyboardInterrupt:
        print("\nโ ุชู ุฅููุงู ุงูุฎุงุฏู")
    except Exception as e:
        print(f"โ ุฎุทุฃ: {e}")
        input("ุงุถุบุท Enter ููุฎุฑูุฌ...")

if __name__ == "__main__":
    main()
